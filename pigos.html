<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PigOS - GitHub P√§ivitys</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { overflow: hidden; background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); height: 100vh; color: white; }
        
        .desktop { width: 100vw; height: 100vh; position: relative; }
        .desktop-icons { position: absolute; top: 20px; left: 20px; }
        .desktop-icon { width: 80px; height: 80px; margin: 10px; text-align: center; cursor: pointer; }
        .icon-image { font-size: 40px; margin-bottom: 5px; }
        .icon-label { font-size: 12px; text-shadow: 0 1px 2px rgba(0,0,0,0.8); }
        
        .taskbar { position: fixed; bottom: 0; left: 0; right: 0; height: 40px; background: rgba(30,30,30,0.9); 
                  display: flex; align-items: center; padding: 0 20px; z-index: 999; }
        .start-button { padding: 0 15px; height: 30px; background: #0078d7; border: none; border-radius: 5px; color: white; cursor: pointer; }
        
        .window { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 600px; 
                  height: 400px; background: white; border-radius: 10px; display: none; flex-direction: column; z-index: 100; }
        .window-header { padding: 15px; background: #0078d7; color: white; border-radius: 10px 10px 0 0; 
                         display: flex; justify-content: space-between; align-items: center; }
        .window-content { flex: 1; padding: 20px; color: #333; overflow: auto; }
        
        .update-notification { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: #4CAF50; 
            color: white; 
            padding: 15px; 
            border-radius: 8px; 
            z-index: 10000; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: none;
        }
        
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3;
                    border-top: 3px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite; }
        
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="desktop">
        <div class="desktop-icons">
            <div class="desktop-icon" onclick="openApp('settings')">
                <div class="icon-image">‚öôÔ∏è</div>
                <div class="icon-label">Asetukset</div>
            </div>
            <div class="desktop-icon" onclick="openApp('info')">
                <div class="icon-image">‚ÑπÔ∏è</div>
                <div class="icon-label">Tietoa</div>
            </div>
        </div>
    </div>

    <div class="taskbar">
        <button class="start-button" onclick="toggleStartMenu()">K√§ynnist√§</button>
        <div style="margin-left: auto;">
            <span id="clock">00:00</span> | 
            <span id="version">v1.0.0</span>
        </div>
    </div>

    <div class="window" id="settings-window">
        <div class="window-header">
            <div class="window-title">‚öôÔ∏è Asetukset</div>
            <div class="window-controls">
                <button onclick="closeApp('settings')" style="background: #ff4757; color: white; border: none; 
                border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">√ó</button>
            </div>
        </div>
        <div class="window-content">
            <h2>J√§rjestelm√§n asetukset</h2>
            
            <div class="setting-item" style="margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 8px;">
                <h3>üîÑ J√§rjestelm√§n p√§ivitykset</h3>
                <p>Tarkista uudet p√§ivitykset GitHubista</p>
                
                <button onclick="checkForUpdates()" style="background: #2E86C1; color: white; padding: 12px 24px; 
                border: none; border-radius: 6px; cursor: pointer; margin: 10px 0; font-size: 16px;">
                    üì° Tarkista p√§ivitykset
                </button>
                
                <div id="update-info" style="margin: 15px 0; padding: 12px; background: #e8f4fc; border-radius: 5px; border-left: 4px solid #2E86C1;">
                    <p>P√§ivityksi√§ ei ole tarkistettu</p>
                </div>
                
                <div style="font-size: 14px; color: #666;">
                    <p>üìä Nykyinen versio: <strong id="current-version">v1.0.0</strong></p>
                    <p>üÜï Viimeisin versio: <strong id="latest-version">-</strong></p>
                </div>
            </div>

            <div class="setting-item" style="margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 8px;">
                <h3>üé® Ulkoasu</h3>
                <label>Teema:</label>
                <select id="theme-select" onchange="changeTheme(this.value)" style="padding: 8px; margin: 10px 0; border-radius: 4px; border: 1px solid #ddd;">
                    <option value="blue">Sininen</option>
                    <option value="dark">Tumma</option>
                    <option value="light">Vaalea</option>
                </select>
            </div>
        </div>
    </div>

    <div class="window" id="info-window">
        <div class="window-header">
            <div class="window-title">‚ÑπÔ∏è Tietoa PigOS:ista</div>
            <div class="window-controls">
                <button onclick="closeApp('info')" style="background: #ff4757; color: white; border: none; 
                border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">√ó</button>
            </div>
        </div>
        <div class="window-content">
            <h2>PigOS v1.0.0</h2>
            <p>HTML-pohjainen k√§ytt√∂j√§rjestelm√§</p>
            
            <div style="margin: 20px 0; padding: 15px; background: #f0f8ff; border-radius: 8px;">
                <h3>üì¶ Ominaisuudet:</h3>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li>GitHub-pohjaiset p√§ivitykset</li>
                    <li>Teemavaihto</li>
                    <li>Ty√∂p√∂yt√§ymp√§rist√∂</li>
                    <li>Asetusvalikko</li>
                </ul>
            </div>
            
            <div style="margin: 20px 0; padding: 15px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
                <h3>üîÑ P√§ivitysohjeet:</h3>
                <p>P√§ivitykset tarkistetaan manuaalisesti asetuksista.</p>
                <p>Uusi versio latautuu automaattisesti GitHubista.</p>
            </div>
        </div>
    </div>

    <div class="update-notification" id="update-notification">
        <h3 style="margin: 0 0 10px 0;">üîÑ Uusi p√§ivitys saatavilla!</h3>
        <p id="update-message" style="margin: 0 0 15px 0;">Versio v1.1.0 on nyt saatavilla</p>
        <div style="display: flex; gap: 10px;">
            <button onclick="installUpdate()" style="background: #4CAF50; color: white; padding: 8px 16px; 
            border: none; border-radius: 4px; cursor: pointer; flex: 1;">
                üì• Asenna p√§ivitys
            </button>
            <button onclick="hideUpdateNotification()" style="background: #f44336; color: white; padding: 8px 16px; 
            border: none; border-radius: 4px; cursor: pointer; flex: 1;">
                ‚ùå Sulje
            </button>
        </div>
    </div>

    <script>
        // P√ÑIVITYSJ√ÑRJESTELM√Ñ GitHubille
        class GitHubUpdateManager {
            constructor() {
                this.currentVersion = localStorage.getItem('pigos_version') || '1.0.0';
                this.updateUrl = 'https://raw.githubusercontent.com/your-username/PigOS-Project/main/version.json';
                this.isChecking = false;
            }

            async checkForUpdates() {
                if (this.isChecking) return;
                
                this.isChecking = true;
                this.showUpdateInfo('<span class="loading"></span> Tarkistetaan p√§ivityksi√§...');
                
                try {
                    const response = await fetch(this.updateUrl + '?t=' + Date.now());
                    
                    if (!response.ok) throw new Error('GitHub ei vastaa');
                    
                    const data = await response.json();
                    
                    document.getElementById('latest-version').textContent = 'v' + data.latestVersion;
                    
                    if (this.isNewVersionAvailable(data.latestVersion)) {
                        this.showUpdateInfo('üéØ <strong>Uusi p√§ivitys saatavilla!</strong> Versio v' + data.latestVersion);
                        this.showUpdateNotification('Uusi versio v' + data.latestVersion + ' saatavilla. Klikkaa asentaaksesi.');
                    } else {
                        this.showUpdateInfo('‚úÖ <strong>J√§rjestelm√§ on ajan tasalla</strong>');
                    }
                    
                } catch (error) {
                    console.error('P√§ivitystarkistus ep√§onnistui:', error);
                    this.showUpdateInfo('‚ùå <strong>P√§ivitysten tarkistus ep√§onnistui</strong><br><small>Yrit√§ my√∂hemmin uudelleen</small>');
                } finally {
                    this.isChecking = false;
                }
            }

            isNewVersionAvailable(latestVersion) {
                const current = this.currentVersion.split('.').map(Number);
                const latest = latestVersion.split('.').map(Number);
                
                for (let i = 0; i < Math.max(current.length, latest.length); i++) {
                    if ((latest[i] || 0) > (current[i] || 0)) return true;
                    if ((latest[i] || 0) < (current[i] || 0)) return false;
                }
                return false;
            }

            async installUpdate() {
                this.showUpdateInfo('<span class="loading"></span> Asennetaan p√§ivityst√§...');
                
                try {
                    // Simuloi p√§ivityksen asennusta
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    localStorage.setItem('pigos_version', '1.1.0');
                    this.currentVersion = '1.1.0';
                    document.getElementById('current-version').textContent = 'v1.1.0';
                    document.getElementById('version').textContent = 'v1.1.0';
                    
                    this.showUpdateInfo('‚úÖ <strong>P√§ivitys asennettu onnistuneesti!</strong>');
                    this.hideUpdateNotification();
                    
                    setTimeout(() => {
                        alert('üéâ PigOS p√§ivitetty versioon v1.1.0!\n\nK√§ynnist√§ sovellus uudelleen n√§hd√§ksesi uudet ominaisuudet.');
                    }, 500);
                    
                } catch (error) {
                    this.showUpdateInfo('‚ùå <strong>P√§ivityksen asennus ep√§onnistui</strong>');
                }
            }

            showUpdateInfo(message) {
                const infoDiv = document.getElementById('update-info');
                if (infoDiv) {
                    infoDiv.innerHTML = `<p>${message}</p>`;
                }
            }

            showUpdateNotification(message) {
                const notification = document.getElementById('update-notification');
                const messageElement = document.getElementById('update-message');
                
                if (notification && messageElement) {
                    messageElement.textContent = message;
                    notification.style.display = 'block';
                }
            }

            hideUpdateNotification() {
                const notification = document.getElementById('update-notification');
                if (notification) {
                    notification.style.display = 'none';
                }
            }
        }

        // GLOBAALIT FUNKTIOT
        function checkForUpdates() {
            if (!window.updateManager) {
                window.updateManager = new GitHubUpdateManager();
            }
            window.updateManager.checkForUpdates();
        }

        function installUpdate() {
            if (window.updateManager) {
                window.updateManager.installUpdate();
            }
        }

        function hideUpdateNotification() {
            if (window.updateManager) {
                window.updateManager.hideUpdateNotification();
            }
        }

        function changeTheme(theme) {
            localStorage.setItem('pigos_theme', theme);
            alert('Teema vaihdettu: ' + theme);
        }

        function openApp(app) {
            document.getElementById('settings-window').style.display = 'flex';
        }

        function closeApp(app) {
            document.getElementById('settings-window').style.display = 'none';
        }

        function toggleStartMenu() {
            openApp('settings');
        }

        // P√§ivit√§ kello
        function updateClock() {
            const now = new Date();
            document.getElementById('clock').textContent = now.toLocaleTimeString('fi-FI');
        }
        setInterval(updateClock, 1000);
        updateClock();

        // Alusta versiotiedot
        document.addEventListener('DOMContentLoaded', () => {
            const version = localStorage.getItem('pigos_version') || '1.0.0';
            document.getElementById('current-version').textContent = 'v' + version;
            document.getElementById('version').textContent = 'v' + version;
            
            const savedTheme = localStorage.getItem('pigos_theme');
            if (savedTheme) {
                document.getElementById('theme-select').value = savedTheme;
            }
        });
    </script>
</body>
</html>